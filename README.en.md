lammps-tools
============

[![ru](https://img.shields.io/badge/lang-ru-red.svg)](https://github.com/xtotdam/lammps-tools/blob/master/README.md)
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.17471957.svg)](https://doi.org/10.5281/zenodo.17471957)



Various utilities for convenient work with LAMMPS

## Scripts

### `archive_run.py`

LAMMPS run archiver. Copies files to a temporary folder, runs the calculation, optionally compiles NEB dumps, archives useful files, and deletes unnecessary files. Allows you to run multiple calculations on the same files with different parameters simultaneously in parallel.

At the beginning of the script, the `patterns` dictionary stores the templates of the file names that will be archived and deleted.

```
# python archive_run.py --help
usage: LAMMPS Runner [-h] [-d] [-n] [-m [MESSAGE ...]] command [command ...]

Runs LAMMPS, compiles NEB files, archives all data

positional arguments:
  command               LAMMPS command to run

options:
  -h, --help            show this help message and exit
  -d, --skip-delete     Skip deletion of files
  -n, --skip-ntfy       Skip NTFY request
  -m [MESSAGE ...], --message [MESSAGE ...]
                        Run description

v0.2
```

#### Example run

`python archive_run.py -m "ontop K=100" -- mpirun -np 8 lmp -partition 8x1 -var K 100 -in ontop-neb.lmp`

Assuming that the script is located in `$PATH`, a full run with task queuing and parameter substitution:

`parallel -j1 tsp archive_run.py -m "K={}" -- mpirun -np 8 lmp -partition 8x1 -var K {} -in ontop-neb.lmp ::: 1 10 100`

#### Dependencies

* `rich` (optional)
* `export LAMMPS_PYTHON_TOOLS=/<...>/lammps/tools/python/pizza` in the `~/.bashrc` file (see [docs](https://github.com/lammps/lammps/tree/develop/tools/python))

### `runs_analyze.py`

The LAMMPS calculation analyzer, which works with the calculation results generated by the script above. :warning:WIP:construction:

TODO: Docs!!

#### Dependencies

* `rich` (optional)
* `plotly`
* `pandas`

#### Example run

```py
from tqdm.notebook import tqdm
import plotly.graph_objects as go
import runs_analyze as ra
LammpsRunFolder, LammpsRun = ra.LammpsRunFolder, ra.LammpsRun

lrf = LammpsRunFolder('runs/p-2mol1')
lrf.describe() # briefly prints all files it found

runs = [ra.LammpsRun(run) for run in lrf.find()]

for run in tqdm(runs):
    run.parse_neb()

# potential barrier profile
fig = go.Figure(layout=dict(width=1000, height=700, xaxis_title_text='Reaction coordinate', yaxis_title_text='Energy, kcal/mol'))
for run in runs:
    fig.add_traces(run.get_energy_path_traces(name=f'+{run.metadata["description"]}'))
fig.show()

# view with ASE
runs[2].view_lammpsdata_with_ase('out.2.lammpsdata')

# see its evolution during run
for run in runs:
    fig = go.Figure(layout=dict(width=1000, height=700, title=run.metadata['description']))
    fig.add_traces(run.get_transition_evolution_traces())
    fig.show()

# same in 3D
for run in runs:
    fig = go.Figure(layout=dict(width=1000, height=700, title=run.metadata['description']))
    fig.add_traces(run.get_3d_energy_traj_traces())
    fig.show()
```

## Viewers

* `view-lammpsdata-in-ase[-3x3x1].cmd` --- for files, created with LAMMPS `write_data` directive
* `view-poscar-in-ase[-3x3x1].cmd` --- for POSCAR (VASP) files
* `view-xyz-in-ase[-3x3x1].cmd` --- for [XYZ](https://en.wikipedia.org/wiki/XYZ_file_format) files

When you drag a file onto this script, the ASE viewer window will open. Scripts with `3x3x1` in the name show a cell repeated three times along the X and Y axes.

To work, you need to have [ASE](https://wiki.fysik.dtu.dk/ase/) installed.

Ovito provides similar functionality with the Replicate modifier.


## Miscellaneous

### `run-with_lammps.cmd`

When you drag a file onto this script, the file will be run in LAMMPS.

### `add-ipynb-file-format.reg`

Adds the ability to create an empty ipynb file from the context menu in Windows Explorer.




Translated with DeepL.com (free version)
